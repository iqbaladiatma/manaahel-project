<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Video Player</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 20px 0; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        video { width: 100%; max-width: 600px; background: #000; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>üîç Debug Video Player</h1>
    
    <!-- Test 1: Basic HTML5 Video -->
    <div class="test">
        <h3>Test 1: Basic HTML5 Video (Cloudinary Demo)</h3>
        <video id="video1" controls>
            <source src="https://res.cloudinary.com/demo/video/upload/sample.mp4" type="video/mp4">
            Browser tidak mendukung video.
        </video>
        <div>
            <button onclick="testVideo('video1')">Test Play</button>
            <button onclick="checkVideoInfo('video1')">Check Info</button>
        </div>
        <div id="status1" class="status info">Klik "Test Play" untuk test</div>
    </div>

    <!-- Test 2: Different Video Sources -->
    <div class="test">
        <h3>Test 2: Alternative Video Sources</h3>
        <video id="video2" controls>
            <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
            <source src="https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4" type="video/mp4">
            Browser tidak mendukung video.
        </video>
        <div>
            <button onclick="testVideo('video2')">Test Play</button>
            <button onclick="checkVideoInfo('video2')">Check Info</button>
        </div>
        <div id="status2" class="status info">Test dengan video dari sumber lain</div>
    </div>

    <!-- Test 3: Custom URL Input -->
    <div class="test">
        <h3>Test 3: Custom Video URL</h3>
        <input type="url" id="customUrl" placeholder="Masukkan URL video Anda" style="width: 70%; padding: 8px; margin-bottom: 10px;">
        <button onclick="loadCustomVideo()">Load Video</button>
        <div id="customVideoContainer"></div>
        <div id="status3" class="status info">Masukkan URL video Cloudinary Anda</div>
    </div>

    <!-- Test 4: Browser Compatibility -->
    <div class="test">
        <h3>Test 4: Browser & System Info</h3>
        <div id="browserInfo"></div>
        <button onclick="checkBrowserSupport()">Check Browser Support</button>
    </div>

    <!-- Test Results -->
    <div class="test">
        <h3>üìä Test Results & Logs</h3>
        <div id="logs" style="max-height: 300px; overflow-y: auto; background: #f8f9fa; padding: 10px; border-radius: 4px;"></div>
        <button onclick="clearLogs()">Clear Logs</button>
    </div>

    <script>
        let logContainer = document.getElementById('logs');

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : 'info';
            logContainer.innerHTML += `<div class="status ${className}">[${timestamp}] ${message}</div>`;
            logContainer.scrollTop = logContainer.scrollHeight;
            console.log(`[${timestamp}] ${message}`);
        }

        function clearLogs() {
            logContainer.innerHTML = '';
        }

        function testVideo(videoId) {
            const video = document.getElementById(videoId);
            const statusDiv = document.getElementById('status' + videoId.slice(-1));
            
            log(`üé¨ Testing video: ${videoId}`);
            
            if (!video) {
                log(`‚ùå Video element not found: ${videoId}`, 'error');
                return;
            }

            // Check if video can be played
            video.load();
            
            const playPromise = video.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    log(`‚úÖ Video ${videoId} playing successfully!`, 'success');
                    statusDiv.textContent = '‚úÖ Video playing successfully!';
                    statusDiv.className = 'status success';
                }).catch(error => {
                    log(`‚ùå Video ${videoId} play failed: ${error.message}`, 'error');
                    statusDiv.textContent = `‚ùå Play failed: ${error.message}`;
                    statusDiv.className = 'status error';
                });
            } else {
                log(`‚ö†Ô∏è Video ${videoId} play() returned undefined`, 'info');
            }
        }

        function checkVideoInfo(videoId) {
            const video = document.getElementById(videoId);
            
            if (!video) {
                log(`‚ùå Video element not found: ${videoId}`, 'error');
                return;
            }

            log(`üìã Video Info for ${videoId}:`);
            log(`- Duration: ${video.duration || 'Unknown'}`);
            log(`- Ready State: ${video.readyState} (0=HAVE_NOTHING, 1=HAVE_METADATA, 2=HAVE_CURRENT_DATA, 3=HAVE_FUTURE_DATA, 4=HAVE_ENOUGH_DATA)`);
            log(`- Network State: ${video.networkState} (0=EMPTY, 1=IDLE, 2=LOADING, 3=NO_SOURCE)`);
            log(`- Current Source: ${video.currentSrc || 'None'}`);
            log(`- Video Width: ${video.videoWidth || 'Unknown'}`);
            log(`- Video Height: ${video.videoHeight || 'Unknown'}`);
            log(`- Paused: ${video.paused}`);
            log(`- Ended: ${video.ended}`);
            log(`- Error: ${video.error ? video.error.message : 'None'}`);
        }

        function loadCustomVideo() {
            const url = document.getElementById('customUrl').value;
            const container = document.getElementById('customVideoContainer');
            const status = document.getElementById('status3');
            
            if (!url) {
                log('‚ùå Please enter a video URL', 'error');
                status.textContent = '‚ùå Please enter a video URL';
                status.className = 'status error';
                return;
            }
            
            log(`üîÑ Loading custom video: ${url}`);
            
            container.innerHTML = `
                <video id="customVideo" controls style="width: 100%; max-width: 600px; margin-top: 10px;">
                    <source src="${url}" type="video/mp4">
                    <source src="${url}" type="video/webm">
                    <source src="${url}" type="video/ogg">
                    Browser tidak mendukung video.
                </video>
                <div style="margin-top: 10px;">
                    <button onclick="testVideo('customVideo')">Test Play</button>
                    <button onclick="checkVideoInfo('customVideo')">Check Info</button>
                    <button onclick="openVideoInNewTab('${url}')">Open in New Tab</button>
                </div>
            `;
            
            status.textContent = '‚úÖ Custom video loaded';
            status.className = 'status success';
            
            // Add event listeners to custom video
            const customVideo = document.getElementById('customVideo');
            addVideoEventListeners(customVideo, 'customVideo');
        }

        function openVideoInNewTab(url) {
            window.open(url, '_blank');
            log(`üîó Opened video in new tab: ${url}`);
        }

        function checkBrowserSupport() {
            const info = document.getElementById('browserInfo');
            
            log('üîç Checking browser support...');
            
            const videoElement = document.createElement('video');
            const canPlayMP4 = videoElement.canPlayType('video/mp4');
            const canPlayWebM = videoElement.canPlayType('video/webm');
            const canPlayOgg = videoElement.canPlayType('video/ogg');
            
            const browserInfo = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine,
                language: navigator.language,
                mp4Support: canPlayMP4,
                webmSupport: canPlayWebM,
                oggSupport: canPlayOgg,
                videoSupport: !!videoElement.canPlayType
            };
            
            info.innerHTML = `
                <div class="status info">
                    <strong>Browser:</strong> ${browserInfo.userAgent}<br>
                    <strong>Platform:</strong> ${browserInfo.platform}<br>
                    <strong>Online:</strong> ${browserInfo.onLine}<br>
                    <strong>Language:</strong> ${browserInfo.language}<br>
                    <strong>MP4 Support:</strong> ${canPlayMP4 || 'No'}<br>
                    <strong>WebM Support:</strong> ${canPlayWebM || 'No'}<br>
                    <strong>OGG Support:</strong> ${canPlayOgg || 'No'}<br>
                    <strong>Video Element Support:</strong> ${browserInfo.videoSupport ? 'Yes' : 'No'}
                </div>
            `;
            
            log(`Browser: ${navigator.userAgent}`);
            log(`MP4 Support: ${canPlayMP4 || 'No'}`);
            log(`WebM Support: ${canPlayWebM || 'No'}`);
            log(`Video Element Support: ${browserInfo.videoSupport ? 'Yes' : 'No'}`);
        }

        function addVideoEventListeners(video, videoId) {
            const events = [
                'loadstart', 'durationchange', 'loadedmetadata', 'loadeddata',
                'progress', 'canplay', 'canplaythrough', 'play', 'pause',
                'seeking', 'seeked', 'ended', 'error', 'stalled', 'suspend',
                'abort', 'emptied', 'waiting'
            ];
            
            events.forEach(eventType => {
                video.addEventListener(eventType, function(e) {
                    if (eventType === 'error') {
                        log(`‚ùå ${videoId} ${eventType}: ${video.error ? video.error.message : 'Unknown error'}`, 'error');
                    } else if (['play', 'canplay', 'canplaythrough'].includes(eventType)) {
                        log(`‚úÖ ${videoId} ${eventType}`, 'success');
                    } else {
                        log(`üì° ${videoId} ${eventType}`);
                    }
                });
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ Debug page loaded');
            
            // Add event listeners to all videos
            const videos = document.querySelectorAll('video');
            videos.forEach((video, index) => {
                addVideoEventListeners(video, `video${index + 1}`);
            });
            
            // Auto-check browser support
            setTimeout(checkBrowserSupport, 1000);
        });
    </script>
</body>
</html>